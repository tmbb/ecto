    <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.17.1">
    <title>Ecto.Migration – Ecto v3.0.0-dev</title>
    <link rel="stylesheet" href="dist/app-110d9134a6.css" />
    
      <link rel="canonical" href="http://hexdocs.pm/ecto/Ecto.Migration.html" />
    
    
      
        <link rel="icon" type="image/png" href="assets/logo.png" />
      
      
    
    <script src="dist/sidebar_items-d4f8a3d044.js"></script>
    <link rel="stylesheet" href="assets/makedown.css"/>
  </head>
  <body data-type="modules">
    <script>try { if(localStorage.getItem('night-mode')) document.body.className += ' night-mode'; } catch (e) { }</script>

    <div class="main">
<button class="sidebar-toggle">
  <span class="icon-menu" aria-hidden="true"></span>
  <span class="sr-only">Toggle Sidebar</span>
</button>
<section class="sidebar">

  
  <a href="Ecto.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        Ecto
      </h1>
      <h2 class="sidebar-projectVersion">
        v3.0.0-dev
      </h2>
    </div>
    
      <img src="assets/logo.png" alt="Ecto" class="sidebar-projectImage">
    
  </a>

  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <input name="q" type="text" id="search-list" class="search-input" placeholder="search" aria-label="Search" autocomplete="off" />
  </form>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    
      <li><a id="exceptions-list" href="#full-list">Exceptions</a></li>
    

    
      <li><a id="tasks-list" href="#full-list">Mix Tasks</a></li>
    
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


      <h1>
        <small class="visible-xs">Ecto v3.0.0-dev</small>
        Ecto.Migration
        
          <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L1" title="View Source" class="view-source" rel="help">
            <span class="icon-code" aria-hidden="true"></span>
            <span class="sr-only">View Source</span>
          </a>
        
      </h1>

      
        <section id="moduledoc">
          <p>Migrations are used to modify your database schema over time.</p>
<p>This module provides many helpers for migrating the database,
allowing developers to use Elixir to alter their storage in
a way that is database independent.</p>
<p>Here is an example:</p>
<pre><code class="nohighlight makeup"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyRepo.Migrations.AddWeatherTable</span><span class="w"> </span><span class="k" data-group-id="2418">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Ecto.Migration</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">up</span><span class="w"> </span><span class="k" data-group-id="2351">do</span><span class="w">
    </span><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2233">(</span><span class="s2">&quot;weather&quot;</span><span class="p" data-group-id="2233">)</span><span class="w"> </span><span class="k" data-group-id="2345">do</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:city</span><span class="p">,</span><span class="w">    </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">size</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:temp_lo</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:temp_hi</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:prcp</span><span class="p">,</span><span class="w">    </span><span class="ss">:float</span><span class="w">

      </span><span class="n">timestamps</span><span class="p" data-group-id="2328">()</span><span class="w">
    </span><span class="k" data-group-id="2345">end</span><span class="w">
  </span><span class="k" data-group-id="2351">end</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">down</span><span class="w"> </span><span class="k" data-group-id="2406">do</span><span class="w">
    </span><span class="n">drop</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2402">(</span><span class="s2">&quot;weather&quot;</span><span class="p" data-group-id="2402">)</span><span class="w">
  </span><span class="k" data-group-id="2406">end</span><span class="w">
</span><span class="k" data-group-id="2418">end</span></code></pre>
<p>Note migrations have an <code class="inline">up/0</code> and <code class="inline">down/0</code> instructions, where
<code class="inline">up/0</code> is used to update your database and <code class="inline">down/0</code> rolls back
the prompted changes.</p>
<p>Ecto provides some mix tasks to help developers work with migrations:</p>
<ul>
<li><code class="inline">mix ecto.gen.migration add_weather_table</code> - generates a
migration that the user can fill in with particular commands
</li>
<li><code class="inline">mix ecto.migrate</code> - migrates a repository
</li>
<li><code class="inline">mix ecto.rollback</code> - rolls back a particular migration
</li>
</ul>
<p>Run the <code class="inline">mix help COMMAND</code> for more information.</p>
<h2 id="module-change" class="section-heading">
  <a href="#module-change" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Change
</h2>

<p>Migrations can also be automatically reversible by implementing
<code class="inline">change/0</code> instead of <code class="inline">up/0</code> and <code class="inline">down/0</code>. For example, the
migration above can be written as:</p>
<pre><code class="nohighlight makeup"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyRepo.Migrations.AddWeatherTable</span><span class="w"> </span><span class="k" data-group-id="2321">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Ecto.Migration</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">change</span><span class="w"> </span><span class="k" data-group-id="2311">do</span><span class="w">
    </span><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2223">(</span><span class="s2">&quot;weather&quot;</span><span class="p" data-group-id="2223">)</span><span class="w"> </span><span class="k" data-group-id="2304">do</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:city</span><span class="p">,</span><span class="w">    </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">size</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:temp_lo</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:temp_hi</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="w">
      </span><span class="n">add</span><span class="w"> </span><span class="ss">:prcp</span><span class="p">,</span><span class="w">    </span><span class="ss">:float</span><span class="w">

      </span><span class="n">timestamps</span><span class="p" data-group-id="2299">()</span><span class="w">
    </span><span class="k" data-group-id="2304">end</span><span class="w">
  </span><span class="k" data-group-id="2311">end</span><span class="w">
</span><span class="k" data-group-id="2321">end</span></code></pre>
<p>Notice not all commands are reversible though. Trying to rollback
a non-reversible command will raise an <a href="Ecto.MigrationError.html"><code class="inline">Ecto.MigrationError</code></a>.</p>
<h2 id="module-field-types" class="section-heading">
  <a href="#module-field-types" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Field Types
</h2>

<p>The Ecto primitive types are mapped to the appropriate database
type by the various database adapters. For example, <code class="inline">:string</code> is converted to
<code class="inline">:varchar</code>, <code class="inline">:binary</code> to <code class="inline">:bits</code> or <code class="inline">:blob</code>, and so on.</p>
<p>Similarly, you can pass any field type supported by your database
as long as it maps to an Ecto type. For instance, you can use <code class="inline">:text</code>,
<code class="inline">:varchar</code> or <code class="inline">:char</code> in your migrations as <code class="inline">add :field_name, :text</code>.
In your Ecto schema, they will all map to the same <code class="inline">:string</code> type.</p>
<p>Remember, atoms can contain arbitrary characters by enclosing in
double quotes the characters following the colon. So, if you want to use
field type with your database specific options, you can pass atoms containing
these options like <code class="inline">:&quot;int unsigned&quot;</code>, <code class="inline">:&quot;time without time zone&quot;</code>.</p>
<h2 id="module-prefixes" class="section-heading">
  <a href="#module-prefixes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Prefixes
</h2>

<p>Migrations support specifying a table prefix or index prefix which will
target either a schema if using Postgres, or a different database if using
MySQL. If no prefix is provided, the default schema or database is used.</p>
<p>Any reference declared in the table migration refers by default to the table
with the same declared prefix. The prefix is specified in the table options:</p>
<pre><code class="nohighlight makeup"><span class="kd">def</span><span class="w"> </span><span class="nf">up</span><span class="w"> </span><span class="k" data-group-id="2465">do</span><span class="w">
  </span><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2228">(</span><span class="s2">&quot;weather&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">prefix</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;north_america&quot;</span><span class="p" data-group-id="2228">)</span><span class="w"> </span><span class="k" data-group-id="2359">do</span><span class="w">
    </span><span class="n">add</span><span class="w"> </span><span class="ss">:city</span><span class="p">,</span><span class="w">    </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">size</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="w">
    </span><span class="n">add</span><span class="w"> </span><span class="ss">:temp_lo</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="w">
    </span><span class="n">add</span><span class="w"> </span><span class="ss">:temp_hi</span><span class="p">,</span><span class="w"> </span><span class="ss">:integer</span><span class="w">
    </span><span class="n">add</span><span class="w"> </span><span class="ss">:prcp</span><span class="p">,</span><span class="w">    </span><span class="ss">:float</span><span class="w">
    </span><span class="n">add</span><span class="w"> </span><span class="ss">:group_id</span><span class="p">,</span><span class="w"> </span><span class="n">references</span><span class="p" data-group-id="2334">(</span><span class="ss">:groups</span><span class="p" data-group-id="2334">)</span><span class="w">

    </span><span class="n">timestamps</span><span class="p" data-group-id="2352">()</span><span class="w">
  </span><span class="k" data-group-id="2359">end</span><span class="w">

  </span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="2455">(</span><span class="s2">&quot;weather&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2421">[</span><span class="ss">:city</span><span class="p" data-group-id="2421">]</span><span class="p">,</span><span class="w"> </span><span class="ss">prefix</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;north_america&quot;</span><span class="p" data-group-id="2455">)</span><span class="w">
</span><span class="k" data-group-id="2465">end</span></code></pre>
<p>Note: if using MySQL with a prefixed table, you must use the same prefix
for the references since cross database references are not supported.</p>
<p>For both MySQL and Postgres with a prefixed table, you must use the same
prefix for the index field to ensure you index the prefix qualified table.</p>
<h2 id="module-transactions" class="section-heading">
  <a href="#module-transactions" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Transactions
</h2>

<p>By default, Ecto runs all migrations inside a transaction. That’s not always
ideal: for example, PostgreSQL allows to create/drop indexes concurrently but
only outside of any transaction (see the <a href="http://www.postgresql.org/docs/9.2/static/sql-createindex.html#SQL-CREATEINDEX-CONCURRENTLY">PostgreSQL
docs</a>).</p>
<p>Migrations can be forced to run outside a transaction by setting the
<code class="inline">@disable_ddl_transaction</code> module attribute to <code class="inline">true</code>:</p>
<pre><code class="nohighlight makeup"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyRepo.Migrations.CreateIndexes</span><span class="w"> </span><span class="k" data-group-id="2273">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Ecto.Migration</span><span class="w">
  </span><span class="na">@disable_ddl_transaction</span><span class="w"> </span><span class="no">true</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">change</span><span class="w"> </span><span class="k" data-group-id="2264">do</span><span class="w">
    </span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="2257">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2242">[</span><span class="ss">:slug</span><span class="p" data-group-id="2242">]</span><span class="p">,</span><span class="w"> </span><span class="ss">concurrently</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="2257">)</span><span class="w">
  </span><span class="k" data-group-id="2264">end</span><span class="w">
</span><span class="k" data-group-id="2273">end</span></code></pre>
<p>Since running migrations outside a transaction can be dangerous, consider
performing very few operations in such migrations.</p>
<p>See the <a href="#index/3"><code class="inline">index/3</code></a> function for more information on creating/dropping indexes
concurrently.</p>
<h2 id="module-comments" class="section-heading">
  <a href="#module-comments" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Comments
</h2>

<p>Migrations where you create or alter a table support specifying table
and column comments, the same can be done when creating constraints
and indexes. At the moment there is support only for Postgres.</p>
<pre><code class="nohighlight makeup"><span class="kd">def</span><span class="w"> </span><span class="nf">up</span><span class="w"> </span><span class="k" data-group-id="2518">do</span><span class="w">
  </span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="2224">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2221">[</span><span class="ss">:name</span><span class="p" data-group-id="2221">]</span><span class="p">,</span><span class="w"> </span><span class="ss">comment</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Index Comment&quot;</span><span class="p" data-group-id="2224">)</span><span class="w">
  </span><span class="n">create</span><span class="w"> </span><span class="n">constraint</span><span class="p" data-group-id="2308">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;price_must_be_positive&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">check</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;price &gt; 0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">comment</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Index Comment&quot;</span><span class="p" data-group-id="2308">)</span><span class="w">
  </span><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2425">(</span><span class="s2">&quot;weather&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">prefix</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;north_america&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">comment</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Table Comment&quot;</span><span class="p" data-group-id="2425">)</span><span class="w"> </span><span class="k" data-group-id="2507">do</span><span class="w">
    </span><span class="n">add</span><span class="w"> </span><span class="ss">:city</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">size</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="ss">comment</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Column Comment&quot;</span><span class="w">
    </span><span class="n">timestamps</span><span class="p" data-group-id="2502">()</span><span class="w">
  </span><span class="k" data-group-id="2507">end</span><span class="w">
</span><span class="k" data-group-id="2518">end</span></code></pre>
<h2 id="module-repo-configuration" class="section-heading">
  <a href="#module-repo-configuration" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Repo configuration
</h2>

<p>The following migration configurations are available for under
a given repository.</p>
<ul>
<li><p><code class="inline">:migration_source</code> - Version numbers of migrations will be saved in
<code class="inline">schema_migrations</code> table but you can configure the table via:</p>
<pre><code class="nohighlight makeup"><span class="n">config</span><span class="w"> </span><span class="ss">:app</span><span class="p">,</span><span class="w"> </span><span class="nc">App.Repo</span><span class="p">,</span><span class="w"> </span><span class="ss">migration_source</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my_migrations&quot;</span></code></pre>
</li>
<li><p><code class="inline">:migration_primary_key</code> - Ecto uses the <code class="inline">:id</code> column with type
<code class="inline">:bigserial</code> but you can configure it via:</p>
<pre><code class="nohighlight makeup"><span class="n">config</span><span class="w"> </span><span class="ss">:app</span><span class="p">,</span><span class="w"> </span><span class="nc">App.Repo</span><span class="p">,</span><span class="w"> </span><span class="ss">migration_primary_key</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="2222">[</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="ss">:uuid</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="ss">:binary_id</span><span class="p" data-group-id="2222">]</span></code></pre>
</li>
<li><p><code class="inline">:migration_timestamps</code> - Ecto uses type <code class="inline">:naive_datetime</code> but you
can configure it via:</p>
<pre><code class="nohighlight makeup"><span class="n">config</span><span class="w"> </span><span class="ss">:app</span><span class="p">,</span><span class="w"> </span><span class="nc">App.Repo</span><span class="p">,</span><span class="w"> </span><span class="ss">migration_timestamps</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="2220">[</span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="ss">:utc_datetime</span><span class="p" data-group-id="2220">]</span></code></pre>
</li>
<li><p><code class="inline">:migration_lock</code> - Ecto will lock the migration table to handle concurrent
migrators using <code class="inline">FOR UPDATE</code> by default but you can configure it via:</p>
<pre><code class="nohighlight makeup"><span class="n">config</span><span class="w"> </span><span class="ss">:app</span><span class="p">,</span><span class="w"> </span><span class="nc">App.Repo</span><span class="p">,</span><span class="w"> </span><span class="ss">migration_lock</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span></code></pre>
</li>
</ul>

        </section>
      

      
        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>
          

          
  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
    <div class="summary-row">
  <div class="summary-signature">
    <a href="#add/3">add(column, type, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Adds a column when creating or altering a table</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#alter/2">alter(object, list)</a>
  </div>
  
    <div class="summary-synopsis"><p>Alters a table</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#constraint/3">constraint(table, name, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Defines a constraint (either a check constraint or an exclusion constraint) to be evaluated by the database when a row is inserted or updated</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#create/1">create(index)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates one of the following</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#create/2">create(object, list)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a table</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#create_if_not_exists/1">create_if_not_exists(index)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates an index or a table with only <code class="inline">:id</code> field if one does not yet exist</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#create_if_not_exists/2">create_if_not_exists(object, list)</a>
  </div>
  
    <div class="summary-synopsis"><p>Creates a table if it does not exist</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#direction/0">direction()</a>
  </div>
  
    <div class="summary-synopsis"><p>Gets the migrator direction</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#drop/1">drop(index_or_table_or_constraint)</a>
  </div>
  
    <div class="summary-synopsis"><p>Drops one of the following</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#drop_if_exists/1">drop_if_exists(index_or_table)</a>
  </div>
  
    <div class="summary-synopsis"><p>Drops a table or index if it exists</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#execute/1">execute(command)</a>
  </div>
  
    <div class="summary-synopsis"><p>Executes arbitrary SQL or a keyword command</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#execute/2">execute(up, down)</a>
  </div>
  
    <div class="summary-synopsis"><p>Executes reversible SQL commands</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#flush/0">flush()</a>
  </div>
  
    <div class="summary-synopsis"><p>Executes queue migration commands</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#fragment/1">fragment(expr)</a>
  </div>
  
    <div class="summary-synopsis"><p>Generates a fragment to be used as default value</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#index/3">index(table, columns, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Returns an index struct that can be used on <code class="inline">create</code>, <code class="inline">drop</code>, etc</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#modify/3">modify(column, type, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Modifies the type of column when altering a table</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#prefix/0">prefix()</a>
  </div>
  
    <div class="summary-synopsis"><p>Gets the migrator prefix</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#references/2">references(table, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Defines a foreign key</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#remove/1">remove(column)</a>
  </div>
  
    <div class="summary-synopsis"><p>Removes a column when altering a table</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#rename/2">rename(table_current, list)</a>
  </div>
  
    <div class="summary-synopsis"><p>Renames a table</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#rename/3">rename(table, current_column, list)</a>
  </div>
  
    <div class="summary-synopsis"><p>Renames a column outside of the <code class="inline">alter</code> statement</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#table/2">table(name, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Returns a table struct that can be given on create, alter, etc</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#timestamps/1">timestamps(opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Adds <code class="inline">:inserted_at</code> and <code class="inline">:updated_at</code> timestamps columns</p>
</div>
  
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#unique_index/3">unique_index(table, columns, opts \\ [])</a>
  </div>
  
    <div class="summary-synopsis"><p>Shortcut for creating a unique index</p>
</div>
  
</div>

  </div>


          

        </section>
      

      

      
        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Functions
          </h1>
          <div class="detail" id="add/3">
  
  
    <span id="add/2"></span>
  
  <div class="detail-header">
    <a href="#add/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">add(column, type, opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L686" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Adds a column when creating or altering a table.</p>
<p>This function also accepts Ecto primitive types as column types
and they are normalized by the database adapter. For example,
<code class="inline">:string</code> is converted to <code class="inline">:varchar</code>, <code class="inline">:binary</code> to <code class="inline">:bits</code> or <code class="inline">:blob</code>,
and so on.</p>
<p>However, the column type is not always the same as the type used in your
schema. For example, a schema that has a <code class="inline">:string</code> field,
can be supported by columns of types <code class="inline">:char</code>, <code class="inline">:varchar</code>, <code class="inline">:text</code> and others.
For this reason, this function also accepts <code class="inline">:text</code> and other columns,
which are sent as is to the underlying database.</p>
<p>To sum up, the column type may be either an Ecto primitive type,
which is normalized in cases the database does not understand it,
like <code class="inline">:string</code> or <code class="inline">:binary</code>, or a database type which is passed as is.
Custom Ecto types, like <a href="Ecto.UUID.html"><code class="inline">Ecto.UUID</code></a>, are not supported because
they are application level concern and may not always map to the
database.</p>
<h2 id="add/3-examples" class="section-heading">
  <a href="#add/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2611">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="2611">)</span><span class="w"> </span><span class="k" data-group-id="2623">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Untitled&quot;</span><span class="w">
</span><span class="k" data-group-id="2623">end</span><span class="w">

</span><span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2632">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="2632">)</span><span class="w"> </span><span class="k" data-group-id="2648">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:summary</span><span class="p">,</span><span class="w"> </span><span class="ss">:text</span><span class="w"> </span><span class="c1"># Database type
</span><span class="w">  </span><span class="n">add</span><span class="w"> </span><span class="ss">:object</span><span class="p">,</span><span class="w">  </span><span class="ss">:map</span><span class="w">  </span><span class="c1"># Elixir type which is handled by the database
</span><span class="k" data-group-id="2648">end</span></code></pre>
<h2 id="add/3-options" class="section-heading">
  <a href="#add/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>

<ul>
<li><code class="inline">:primary_key</code> - when true, marks this field as the primary key
</li>
<li><code class="inline">:default</code> - the column’s default value. can be a string, number
or a fragment generated by <a href="#fragment/1"><code class="inline">fragment/1</code></a>
</li>
<li><code class="inline">:null</code> - when <code class="inline">false</code>, the column does not allow null values
</li>
<li><code class="inline">:size</code> - the size of the type (for example the numbers of characters).
Default is no size, except for <code class="inline">:string</code> that defaults to 255.
</li>
<li><code class="inline">:precision</code> - the precision for a numeric type. Required when <code class="inline">scale</code> is specified.
</li>
<li><code class="inline">:scale</code> - the scale of a numeric type. Default is 0 scale
</li>
</ul>

  </section>
</div>
<div class="detail" id="alter/2">
  
  
  <div class="detail-header">
    <a href="#alter/2" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <span class="signature">alter(object, list)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L332" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
      <span class="note">(macro)</span>
    
    
  </div>
  <section class="docstring">
    <p>Alters a table.</p>
<h2 id="alter/2-examples" class="section-heading">
  <a href="#alter/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2669">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="2669">)</span><span class="w"> </span><span class="k" data-group-id="2681">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:summary</span><span class="p">,</span><span class="w"> </span><span class="ss">:text</span><span class="w">
  </span><span class="n">modify</span><span class="w"> </span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">:text</span><span class="w">
  </span><span class="n">remove</span><span class="w"> </span><span class="ss">:views</span><span class="w">
</span><span class="k" data-group-id="2681">end</span></code></pre>

  </section>
</div>
<div class="detail" id="constraint/3">
  
  
    <span id="constraint/2"></span>
  
  <div class="detail-header">
    <a href="#constraint/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">constraint(table, name, opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L878" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Defines a constraint (either a check constraint or an exclusion constraint) to be evaluated by the database when a row is inserted or updated.</p>
<h2 id="constraint/3-examples" class="section-heading">
  <a href="#constraint/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create</span><span class="w"> </span><span class="n">constraint</span><span class="p" data-group-id="2704">(</span><span class="s2">&quot;users&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">:price_must_be_positive</span><span class="p">,</span><span class="w"> </span><span class="ss">check</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;price &gt; 0&quot;</span><span class="p" data-group-id="2704">)</span><span class="w">
</span><span class="n">create</span><span class="w"> </span><span class="n">constraint</span><span class="p" data-group-id="2730">(</span><span class="s2">&quot;size_ranges&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">:no_overlap</span><span class="p">,</span><span class="w"> </span><span class="ss">exclude</span><span class="p">:</span><span class="w"> </span><span class="s">~s|gist (int4range(&quot;from&quot;, &quot;to&quot;, &apos;[]&apos;) WITH &amp;&amp;)|</span><span class="p" data-group-id="2730">)</span><span class="w">
</span><span class="n">drop</span><span class="w">   </span><span class="n">constraint</span><span class="p" data-group-id="2746">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;price_must_be_positive&quot;</span><span class="p" data-group-id="2746">)</span></code></pre>
<h2 id="constraint/3-options" class="section-heading">
  <a href="#constraint/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>

<ul>
<li><code class="inline">:check</code> - A check constraint expression. Required when creating a check constraint.
</li>
<li><code class="inline">:exclude</code> - An exclusion constraint expression. Required when creating an exclusion constraint.
</li>
</ul>

  </section>
</div>
<div class="detail" id="create/1">
  
  
  <div class="detail-header">
    <a href="#create/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">create(index)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L368" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates one of the following:</p>
<ul>
<li>an index
</li>
<li>a table with only an <code class="inline">:id</code> field
</li>
<li>a constraint
</li>
</ul>
<p>When reversing (in <code class="inline">change</code> running backward) indexes are only dropped if they
exist and no errors are raised. To enforce dropping an index use <a href="#drop/1"><code class="inline">drop/1</code></a>.</p>
<h2 id="create/1-examples" class="section-heading">
  <a href="#create/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="2777">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2776">[</span><span class="ss">:name</span><span class="p" data-group-id="2776">]</span><span class="p" data-group-id="2777">)</span><span class="w">
</span><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2785">(</span><span class="s2">&quot;version&quot;</span><span class="p" data-group-id="2785">)</span><span class="w">
</span><span class="n">create</span><span class="w"> </span><span class="n">constraint</span><span class="p" data-group-id="2807">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;price_must_be_positive&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">check</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;price &gt; 0&quot;</span><span class="p" data-group-id="2807">)</span></code></pre>

  </section>
</div>
<div class="detail" id="create/2">
  
  
  <div class="detail-header">
    <a href="#create/2" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <span class="signature">create(object, list)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L290" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
      <span class="note">(macro)</span>
    
    
  </div>
  <section class="docstring">
    <p>Creates a table.</p>
<p>By default, the table will also include a primary_key of name <code class="inline">:id</code>
and type <code class="inline">:bigserial</code>. Check <a href="#table/2"><code class="inline">table/2</code></a> docs for more information.</p>
<h2 id="create/2-examples" class="section-heading">
  <a href="#create/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2814">(</span><span class="ss">:posts</span><span class="p" data-group-id="2814">)</span><span class="w"> </span><span class="k" data-group-id="2831">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Untitled&quot;</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:body</span><span class="p">,</span><span class="w">  </span><span class="ss">:text</span><span class="w">

  </span><span class="n">timestamps</span><span class="p" data-group-id="2829">()</span><span class="w">
</span><span class="k" data-group-id="2831">end</span></code></pre>

  </section>
</div>
<div class="detail" id="create_if_not_exists/1">
  
  
  <div class="detail-header">
    <a href="#create_if_not_exists/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">create_if_not_exists(index)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L387" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Creates an index or a table with only <code class="inline">:id</code> field if one does not yet exist.</p>
<h2 id="create_if_not_exists/1-examples" class="section-heading">
  <a href="#create_if_not_exists/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create_if_not_exists</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="2848">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2847">[</span><span class="ss">:name</span><span class="p" data-group-id="2847">]</span><span class="p" data-group-id="2848">)</span><span class="w">

</span><span class="n">create_if_not_exists</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2853">(</span><span class="s2">&quot;version&quot;</span><span class="p" data-group-id="2853">)</span></code></pre>

  </section>
</div>
<div class="detail" id="create_if_not_exists/2">
  
  
  <div class="detail-header">
    <a href="#create_if_not_exists/2" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <span class="signature">create_if_not_exists(object, list)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L300" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
      <span class="note">(macro)</span>
    
    
  </div>
  <section class="docstring">
    <p>Creates a table if it does not exist.</p>
<p>Works just like <a href="#create/2"><code class="inline">create/2</code></a> but does not raise an error when table
already exists.</p>

  </section>
</div>
<div class="detail" id="direction/0">
  
  
  <div class="detail-header">
    <a href="#direction/0" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">direction()</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L624" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
      <div class="specs">
        
          <pre>direction() :: :up | :down</pre>
        
      </div>
    
  </div>
  <section class="docstring">
    <p>Gets the migrator direction.</p>

  </section>
</div>
<div class="detail" id="drop/1">
  
  
  <div class="detail-header">
    <a href="#drop/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">drop(index_or_table_or_constraint)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L416" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Drops one of the following:</p>
<ul>
<li>an index
</li>
<li>a table
</li>
<li>a constraint
</li>
</ul>
<h2 id="drop/1-examples" class="section-heading">
  <a href="#drop/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">drop</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="2876">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2875">[</span><span class="ss">:name</span><span class="p" data-group-id="2875">]</span><span class="p" data-group-id="2876">)</span><span class="w">
</span><span class="n">drop</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2880">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="2880">)</span><span class="w">
</span><span class="n">drop</span><span class="w"> </span><span class="n">constraint</span><span class="p" data-group-id="2897">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;price_must_be_positive&quot;</span><span class="p" data-group-id="2897">)</span></code></pre>

  </section>
</div>
<div class="detail" id="drop_if_exists/1">
  
  
  <div class="detail-header">
    <a href="#drop_if_exists/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">drop_if_exists(index_or_table)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L432" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Drops a table or index if it exists.</p>
<p>Does not raise an error if table or index does not exist.</p>
<h2 id="drop_if_exists/1-examples" class="section-heading">
  <a href="#drop_if_exists/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">drop_if_exists</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="2932">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2931">[</span><span class="ss">:name</span><span class="p" data-group-id="2931">]</span><span class="p" data-group-id="2932">)</span><span class="w">
</span><span class="n">drop_if_exists</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="2938">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="2938">)</span></code></pre>

  </section>
</div>
<div class="detail" id="execute/1">
  
  
  <div class="detail-header">
    <a href="#execute/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">execute(command)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L599" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Executes arbitrary SQL or a keyword command.</p>
<p>Reversible commands can be defined by calling <a href="#execute/2"><code class="inline">execute/2</code></a>.</p>
<h2 id="execute/1-examples" class="section-heading">
  <a href="#execute/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">execute</span><span class="w"> </span><span class="s2">&quot;CREATE EXTENSION postgres_fdw&quot;</span><span class="w">

</span><span class="n">execute</span><span class="w"> </span><span class="ss">create</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;posts&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">capped</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="ss">size</span><span class="p">:</span><span class="w"> </span><span class="mi">1024</span></code></pre>

  </section>
</div>
<div class="detail" id="execute/2">
  
  
  <div class="detail-header">
    <a href="#execute/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">execute(up, down)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L615" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Executes reversible SQL commands.</p>
<p>This is useful for database-specific functionality that does not
warrant special support in Ecto, for example, creating and dropping
a PostgreSQL extension, and avoids having to define up/down blocks.</p>
<h2 id="execute/2-examples" class="section-heading">
  <a href="#execute/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">execute</span><span class="w"> </span><span class="s2">&quot;CREATE EXTENSION postgres_fdw&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DROP EXTENSION postgres_fdw&quot;</span></code></pre>

  </section>
</div>
<div class="detail" id="flush/0">
  
  
  <div class="detail-header">
    <a href="#flush/0" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">flush()</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L888" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Executes queue migration commands.</p>
<p>Reverses the order commands are executed when doing a rollback
on a change/0 function and resets commands queue.</p>

  </section>
</div>
<div class="detail" id="fragment/1">
  
  
  <div class="detail-header">
    <a href="#fragment/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">fragment(expr)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L728" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Generates a fragment to be used as default value.</p>
<h2 id="fragment/1-examples" class="section-heading">
  <a href="#fragment/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3007">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="3007">)</span><span class="w"> </span><span class="k" data-group-id="3021">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:inserted_at</span><span class="p">,</span><span class="w"> </span><span class="ss">:naive_datetime</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">:</span><span class="w"> </span><span class="n">fragment</span><span class="p" data-group-id="3017">(</span><span class="s2">&quot;now()&quot;</span><span class="p" data-group-id="3017">)</span><span class="w">
</span><span class="k" data-group-id="3021">end</span></code></pre>

  </section>
</div>
<div class="detail" id="index/3">
  
  
    <span id="index/2"></span>
  
  <div class="detail-header">
    <a href="#index/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">index(table, columns, opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L562" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Returns an index struct that can be used on <code class="inline">create</code>, <code class="inline">drop</code>, etc.</p>
<p>Expects the table name as first argument and the index fields as
second. The field can be an atom, representing a column, or a
string representing an expression that is sent as is to the database.</p>
<p>Indexes are non-unique by default.</p>
<h2 id="index/3-options" class="section-heading">
  <a href="#index/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>

<ul>
<li><code class="inline">:name</code> - the name of the index. Defaults to “#{table}_#{column}_index”
</li>
<li><code class="inline">:unique</code> - if the column(s) is unique or not
</li>
<li><code class="inline">:concurrently</code> - if the index should be created/dropped concurrently
</li>
<li><code class="inline">:using</code> - configures the index type
</li>
<li><code class="inline">:prefix</code> - prefix for the index
</li>
<li><code class="inline">:where</code> - the conditions for a partial index
</li>
</ul>
<h2 id="index/3-adding-dropping-indexes-concurrently" class="section-heading">
  <a href="#index/3-adding-dropping-indexes-concurrently" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Adding/dropping indexes concurrently
</h2>

<p>PostgreSQL supports adding/dropping indexes concurrently (see the
<a href="http://www.postgresql.org/docs/9.4/static/sql-createindex.html">docs</a>).
In order to take advantage of this, the <code class="inline">:concurrently</code> option needs to be set
to <code class="inline">true</code> when the index is created/dropped.</p>
<p><strong>Note</strong>: in order for the <code class="inline">:concurrently</code> option to work, the migration must
not be run inside a transaction. See the <a href="Ecto.Migration.html#content"><code class="inline">Ecto.Migration</code></a> docs for more
information on running migrations outside of a transaction.</p>
<h2 id="index/3-index-types" class="section-heading">
  <a href="#index/3-index-types" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Index types
</h2>

<p>PostgreSQL supports several index types like B-tree, Hash or GiST. When
creating an index, the index type defaults to B-tree, but it can be specified
with the <code class="inline">:using</code> option. The <code class="inline">:using</code> option can be an atom or a string; its
value is passed to the <code class="inline">USING</code> clause as is.</p>
<p>More information on index types can be found in the <a href="http://www.postgresql.org/docs/9.4/static/indexes-types.html">PostgreSQL
docs</a>.</p>
<h2 id="index/3-partial-indexes" class="section-heading">
  <a href="#index/3-partial-indexes" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Partial indexes
</h2>

<p>Databases like PostgreSQL and MSSQL supports partial indexes.</p>
<p>A partial index is an index built over a subset of a table. The subset
is defined by a conditional expression using the <code class="inline">:where</code> option.
The <code class="inline">:where</code> option can be an atom or a string; its value is passed
to the <code class="inline">WHERE</code> clause as is.</p>
<p>More information on partial indexes can be found in the <a href="http://www.postgresql.org/docs/9.4/static/indexes-partial.html">PostgreSQL
docs</a>.</p>
<h2 id="index/3-examples" class="section-heading">
  <a href="#index/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="c1"># Without a name, index defaults to products_category_id_sku_index
</span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="3056">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3051">[</span><span class="ss">:category_id</span><span class="p">,</span><span class="w"> </span><span class="ss">:sku</span><span class="p" data-group-id="3051">]</span><span class="p">,</span><span class="w"> </span><span class="ss">unique</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="3056">)</span><span class="w">

</span><span class="c1"># Name can be given explicitly though
</span><span class="n">drop</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="3091">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3079">[</span><span class="ss">:category_id</span><span class="p">,</span><span class="w"> </span><span class="ss">:sku</span><span class="p" data-group-id="3079">]</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="ss">:my_special_name</span><span class="p" data-group-id="3091">)</span><span class="w">

</span><span class="c1"># Indexes can be added concurrently
</span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="3129">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3127">[</span><span class="ss">:category_id</span><span class="p">,</span><span class="w"> </span><span class="ss">:sku</span><span class="p" data-group-id="3127">]</span><span class="p">,</span><span class="w"> </span><span class="ss">concurrently</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="3129">)</span><span class="w">

</span><span class="c1"># The index type can be specified
</span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="3151">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3144">[</span><span class="ss">:name</span><span class="p" data-group-id="3144">]</span><span class="p">,</span><span class="w"> </span><span class="ss">using</span><span class="p">:</span><span class="w"> </span><span class="ss">:hash</span><span class="p" data-group-id="3151">)</span><span class="w">

</span><span class="c1"># Create a partial index
</span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="3176">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3169">[</span><span class="ss">:user_id</span><span class="p" data-group-id="3169">]</span><span class="p">,</span><span class="w"> </span><span class="ss">where</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;price = 0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="ss">:free_products_index</span><span class="p" data-group-id="3176">)</span></code></pre>
<p>Indexes also support custom expressions. Some databases may require the
index expression to be written between parens:</p>
<pre><code class="nohighlight makeup"><span class="c1"># Create an index on custom expressions
</span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="3053">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3050">[</span><span class="s2">&quot;(lower(name))&quot;</span><span class="p" data-group-id="3050">]</span><span class="p">,</span><span class="w"> </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="ss">:products_lower_name_index</span><span class="p" data-group-id="3053">)</span><span class="w">

</span><span class="c1"># To create a tsvector index with GIN on Postgres
</span><span class="n">create</span><span class="w"> </span><span class="n">index</span><span class="p" data-group-id="3114">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3087">[</span><span class="s2">&quot;(to_tsvector(&apos;english&apos;, name))&quot;</span><span class="p" data-group-id="3087">]</span><span class="p">,</span><span class="w">
             </span><span class="ss">name</span><span class="p">:</span><span class="w"> </span><span class="ss">:products_name_vector</span><span class="p">,</span><span class="w"> </span><span class="ss">using</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GIN&quot;</span><span class="p" data-group-id="3114">)</span></code></pre>

  </section>
</div>
<div class="detail" id="modify/3">
  
  
    <span id="modify/2"></span>
  
  <div class="detail-header">
    <a href="#modify/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">modify(column, type, opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L787" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Modifies the type of column when altering a table.</p>
<p>This command is not reversible as Ecto does not know what
is the current type to revert it back to.</p>
<p>See <a href="#add/3"><code class="inline">add/3</code></a> for more information on supported types.</p>
<h2 id="modify/3-examples" class="section-heading">
  <a href="#modify/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3191">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="3191">)</span><span class="w"> </span><span class="k" data-group-id="3193">do</span><span class="w">
  </span><span class="n">modify</span><span class="w"> </span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">:text</span><span class="w">
</span><span class="k" data-group-id="3193">end</span></code></pre>
<h2 id="modify/3-options" class="section-heading">
  <a href="#modify/3-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>

<ul>
<li><code class="inline">:null</code> - sets to null or not null
</li>
<li><code class="inline">:default</code> - changes the default
</li>
<li><code class="inline">:size</code> - the size of the type (for example the numbers of characters). Default is no size.
</li>
<li><code class="inline">:precision</code> - the precision for a numeric type. Required when <code class="inline">scale</code> is specified.
</li>
<li><code class="inline">:scale</code> - the scale of a numeric type. Default is 0 scale.
</li>
</ul>

  </section>
</div>
<div class="detail" id="prefix/0">
  
  
  <div class="detail-header">
    <a href="#prefix/0" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">prefix()</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L631" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Gets the migrator prefix.</p>

  </section>
</div>
<div class="detail" id="references/2">
  
  
    <span id="references/1"></span>
  
  <div class="detail-header">
    <a href="#references/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">references(table, opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L841" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Defines a foreign key.</p>
<h2 id="references/2-examples" class="section-heading">
  <a href="#references/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3210">(</span><span class="s2">&quot;products&quot;</span><span class="p" data-group-id="3210">)</span><span class="w"> </span><span class="k" data-group-id="3220">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:group_id</span><span class="p">,</span><span class="w"> </span><span class="n">references</span><span class="p" data-group-id="3219">(</span><span class="s2">&quot;groups&quot;</span><span class="p" data-group-id="3219">)</span><span class="w">
</span><span class="k" data-group-id="3220">end</span></code></pre>
<h2 id="references/2-options" class="section-heading">
  <a href="#references/2-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>

<ul>
<li><code class="inline">:name</code> - The name of the underlying reference,
defaults to “#{table}_#{column}_fkey”
</li>
<li><code class="inline">:column</code> - The foreign key column, default is <code class="inline">:id</code>
</li>
<li><code class="inline">:type</code>   - The foreign key type, default is <code class="inline">:bigserial</code>
</li>
<li><code class="inline">:on_delete</code> - What to perform if the referenced entry
 is deleted. May be <code class="inline">:nothing</code>, <code class="inline">:delete_all</code>,
 <code class="inline">:nilify_all</code> or <code class="inline">:restrict</code>. Defaults to <code class="inline">:nothing</code>.
</li>
<li><code class="inline">:on_update</code> - What to perform if the referenced entry
 is updated. May be <code class="inline">:nothing</code>, <code class="inline">:update_all</code>,
 <code class="inline">:nilify_all</code> or <code class="inline">:restrict</code>. Defaults to <code class="inline">:nothing</code>.
</li>
</ul>

  </section>
</div>
<div class="detail" id="remove/1">
  
  
  <div class="detail-header">
    <a href="#remove/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">remove(column)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L808" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Removes a column when altering a table.</p>
<p>This command is not reversible as Ecto does not know what
is the current type to add the column back as.</p>
<h2 id="remove/1-examples" class="section-heading">
  <a href="#remove/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">alter</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3223">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="3223">)</span><span class="w"> </span><span class="k" data-group-id="3225">do</span><span class="w">
  </span><span class="n">remove</span><span class="w"> </span><span class="ss">:title</span><span class="w">
</span><span class="k" data-group-id="3225">end</span></code></pre>

  </section>
</div>
<div class="detail" id="rename/2">
  
  
  <div class="detail-header">
    <a href="#rename/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">rename(table_current, list)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L702" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Renames a table.</p>
<h2 id="rename/2-examples" class="section-heading">
  <a href="#rename/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">rename</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3235">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="3235">)</span><span class="p">,</span><span class="w"> </span><span class="ss">to</span><span class="p">:</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3242">(</span><span class="s2">&quot;new_posts&quot;</span><span class="p" data-group-id="3242">)</span></code></pre>

  </section>
</div>
<div class="detail" id="rename/3">
  
  
  <div class="detail-header">
    <a href="#rename/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">rename(table, current_column, list)</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L714" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Renames a column outside of the <code class="inline">alter</code> statement.</p>
<h2 id="rename/3-examples" class="section-heading">
  <a href="#rename/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">rename</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3251">(</span><span class="s2">&quot;posts&quot;</span><span class="p" data-group-id="3251">)</span><span class="p">,</span><span class="w"> </span><span class="ss">:title</span><span class="p">,</span><span class="w"> </span><span class="ss">to</span><span class="p">:</span><span class="w"> </span><span class="ss">:summary</span></code></pre>

  </section>
</div>
<div class="detail" id="table/2">
  
  
    <span id="table/1"></span>
  
  <div class="detail-header">
    <a href="#table/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">table(name, opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L470" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Returns a table struct that can be given on create, alter, etc.</p>
<h2 id="table/2-examples" class="section-heading">
  <a href="#table/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup"><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3275">(</span><span class="s2">&quot;products&quot;</span><span class="p" data-group-id="3275">)</span><span class="w"> </span><span class="k" data-group-id="3292">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:price</span><span class="p">,</span><span class="w"> </span><span class="ss">:decimal</span><span class="w">
</span><span class="k" data-group-id="3292">end</span><span class="w">

</span><span class="n">drop</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3297">(</span><span class="s2">&quot;products&quot;</span><span class="p" data-group-id="3297">)</span><span class="w">

</span><span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="p" data-group-id="3307">(</span><span class="s2">&quot;products&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">primary_key</span><span class="p">:</span><span class="w"> </span><span class="no">false</span><span class="p" data-group-id="3307">)</span><span class="w"> </span><span class="k" data-group-id="3318">do</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="ss">:string</span><span class="w">
  </span><span class="n">add</span><span class="w"> </span><span class="ss">:price</span><span class="p">,</span><span class="w"> </span><span class="ss">:decimal</span><span class="w">
</span><span class="k" data-group-id="3318">end</span></code></pre>
<h2 id="table/2-options" class="section-heading">
  <a href="#table/2-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>

<ul>
<li><code class="inline">:primary_key</code> - when false, does not generate primary key on table creation
</li>
<li><code class="inline">:engine</code> - customizes the table storage for supported databases. For MySQL,
the default is InnoDB
</li>
<li><code class="inline">:prefix</code> - the prefix for the table
</li>
<li><code class="inline">:options</code> - provide custom options that will be appended after generated
statement, for example “WITH”, “INHERITS” or “ON COMMIT” clauses
</li>
</ul>

  </section>
</div>
<div class="detail" id="timestamps/1">
  
  
    <span id="timestamps/0"></span>
  
  <div class="detail-header">
    <a href="#timestamps/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">timestamps(opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L746" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Adds <code class="inline">:inserted_at</code> and <code class="inline">:updated_at</code> timestamps columns.</p>
<p>Those columns are of <code class="inline">:naive_datetime</code> type, and by default
cannot be null. <code class="inline">opts</code> can be given to customize the generated
fields.</p>
<h2 id="timestamps/1-options" class="section-heading">
  <a href="#timestamps/1-options" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Options
</h2>

<ul>
<li><code class="inline">:inserted_at</code> -  the name of the column for insertion times, providing <code class="inline">false</code> disables column
</li>
<li><code class="inline">:updated_at</code> - the name of the column for update times, providing <code class="inline">false</code> disables column
</li>
<li><code class="inline">:type</code> - column type, defaults to <code class="inline">:naive_datetime</code>
</li>
</ul>

  </section>
</div>
<div class="detail" id="unique_index/3">
  
  
    <span id="unique_index/2"></span>
  
  <div class="detail-header">
    <a href="#unique_index/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <span class="signature">unique_index(table, columns, opts \\ [])</span>
    
      <a href="https://github.com/elixir-ecto/ecto/blob/v3.0.0-dev/lib/ecto/migration.ex#L574" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
    
    
    
  </div>
  <section class="docstring">
    <p>Shortcut for creating a unique index.</p>
<p>See <a href="#index/3"><code class="inline">index/3</code></a> for more information.</p>

  </section>
</div>

        </section>
      

      
          <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.17.1),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
        <button class="night-mode-toggle"><span class="sr-only">Switch theme</span></button>
      </footer>
    </div>
  </div>
</section>
</div>
  <script src="dist/app-4cfb39be16.js"></script>
  <script src="assets/makedown.js"></script>
  </body>
</html>

